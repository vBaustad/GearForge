(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{63:(e,a,s)=>{"use strict";var t=s(7260);s.o(t,"usePathname")&&s.d(a,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(a,{useSearchParams:function(){return t.useSearchParams}})},422:e=>{e.exports={style:{fontFamily:"'Cinzel', 'Cinzel Fallback'",fontStyle:"normal"},className:"__className_a5db66",variable:"__variable_a5db66"}},508:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},1290:()=>{},1786:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},4830:(e,a,s)=>{"use strict";s.d(a,{m:()=>n});var t=s(5155),r=s(6924);function n(e){let{size:a="normal",className:s=""}=e,{login:n,isLoading:l}=(0,r.A)();return(0,t.jsxs)("button",{onClick:n,disabled:l,className:"blizzard-login-btn ".concat("large"===a?"blizzard-login-btn-lg":""," ").concat(s),children:[(0,t.jsx)("img",{src:"https://wow.zamimg.com/images/zul/icons/for-buttons/bnet-large.png",alt:"",className:"blizzard-logo",draggable:!1}),(0,t.jsx)("span",{children:l?"Connecting...":"Login with Battle.net"})]})}},5151:(e,a,s)=>{Promise.resolve().then(s.bind(s,8839)),Promise.resolve().then(s.t.bind(s,2619,23)),Promise.resolve().then(s.t.bind(s,422,23)),Promise.resolve().then(s.t.bind(s,1290,23)),Promise.resolve().then(s.bind(s,6262))},5221:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},5229:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5870:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6262:(e,a,s)=>{"use strict";s.d(a,{Header:()=>A});var t=s(5155),r=s(2115),n=s(2619),l=s.n(n),i=s(63),c=s(6651),o=s(5221),d=s(1786),h=s(6617),u=s(508),m=s(1847);let p=(0,m.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),x=(0,m.A)("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);var j=s(5870),g=s(7910);let k=(0,m.A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var b=s(5229);let v=(0,m.A)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]);var y=s(6924),f=s(4830);function N(e){let{href:a,children:s,onClick:r,className:n=""}=e,c=(0,i.usePathname)(),o=c===a||(null==c?void 0:c.startsWith(a+"/"));return(0,t.jsx)(l(),{href:a,className:"".concat(n," ").concat(o?"active":""),onClick:r,children:s})}function A(){let[e,a]=(0,r.useState)(""),[s,n]=(0,r.useState)(!1),[m,A]=(0,r.useState)(!1),z=(0,i.useRouter)(),{user:C,isAuthenticated:w,isLoading:P,logout:_}=(0,y.A)(),S=async()=>{await _(),n(!1)};return(0,t.jsx)("header",{className:"header",role:"banner",children:(0,t.jsxs)("div",{className:"header-container",children:[(0,t.jsxs)("div",{className:"header-main",children:[(0,t.jsxs)(l(),{href:"/",className:"header-logo",children:[(0,t.jsx)("img",{src:"/gearforge_logo_new.png",alt:"GearForge",className:"header-logo-img"}),(0,t.jsx)("span",{className:"header-logo-text",children:"GearForge"})]}),(0,t.jsxs)("form",{onSubmit:s=>{s.preventDefault(),e.trim()&&(z.push("/browse?q=".concat(encodeURIComponent(e.trim()))),a(""))},className:"header-search",role:"search",children:[(0,t.jsx)(c.A,{size:18,className:"header-search-icon","aria-hidden":"true"}),(0,t.jsx)("input",{type:"search",placeholder:"Search designs...",value:e,onChange:e=>a(e.target.value),className:"header-search-input","aria-label":"Search designs"})]}),(0,t.jsxs)("nav",{className:"header-nav","aria-label":"Main navigation",children:[(0,t.jsxs)(N,{href:"/browse",className:"header-nav-link",children:[(0,t.jsx)(o.A,{size:18}),(0,t.jsx)("span",{children:"Browse"})]}),(0,t.jsxs)(N,{href:"/upload",className:"header-nav-link",children:[(0,t.jsx)(d.A,{size:18}),(0,t.jsx)("span",{children:"Upload"})]}),(0,t.jsxs)(N,{href:"/decor",className:"header-nav-link",children:[(0,t.jsx)(h.A,{size:18}),(0,t.jsx)("span",{children:"Items"})]}),P?(0,t.jsx)("div",{className:"header-login",style:{opacity:.5},children:(0,t.jsx)("div",{className:"skeleton",style:{width:"18px",height:"18px",borderRadius:"50%"}})}):w&&C?(0,t.jsxs)("div",{className:"user-menu-container",children:[(0,t.jsxs)("button",{className:"header-user-btn",onClick:()=>n(!s),"aria-expanded":s,"aria-haspopup":"menu","aria-label":"User menu",children:[(0,t.jsx)("div",{className:"header-user-avatar",children:C.avatarUrl?(0,t.jsx)("img",{src:C.avatarUrl,alt:C.battleTag}):(0,t.jsx)(u.A,{size:16})}),(0,t.jsx)("span",{className:"header-user-name",children:C.battleTag.split("#")[0]}),(0,t.jsx)(p,{size:14})]}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"user-menu-backdrop",onClick:()=>n(!1),"aria-hidden":"true"}),(0,t.jsxs)("div",{className:"user-menu",role:"menu",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"user-menu-header",children:(0,t.jsx)("span",{className:"user-menu-battletag",children:C.battleTag})}),(0,t.jsxs)("button",{className:"user-menu-item",onClick:e=>{e.stopPropagation(),n(!1),z.push("/user/".concat(C.id))},children:[(0,t.jsx)(x,{size:16}),"My Profile"]}),(0,t.jsxs)("button",{className:"user-menu-item",onClick:e=>{e.stopPropagation(),n(!1),z.push("/settings")},children:[(0,t.jsx)(j.A,{size:16}),"Settings"]}),"admin"===C.role&&(0,t.jsxs)("button",{className:"user-menu-item user-menu-admin",onClick:e=>{e.stopPropagation(),n(!1),z.push("/admin")},children:[(0,t.jsx)(g.A,{size:16}),"Admin Panel"]}),(0,t.jsxs)("button",{onClick:S,className:"user-menu-item",children:[(0,t.jsx)(k,{size:16}),"Logout"]})]})]})]}):(0,t.jsx)(f.m,{className:"header-blizzard-btn"})]}),(0,t.jsx)("button",{className:"mobile-menu-btn",onClick:()=>A(!m),"aria-label":"Toggle menu",children:m?(0,t.jsx)(b.A,{size:24}):(0,t.jsx)(v,{size:24})})]}),m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mobile-menu-backdrop",onClick:()=>A(!1),"aria-hidden":"true"}),(0,t.jsxs)("nav",{className:"mobile-menu","aria-label":"Mobile navigation",children:[(0,t.jsxs)(N,{href:"/browse",className:"mobile-menu-link",onClick:()=>A(!1),children:[(0,t.jsx)(o.A,{size:20}),"Browse"]}),(0,t.jsxs)(N,{href:"/upload",className:"mobile-menu-link",onClick:()=>A(!1),children:[(0,t.jsx)(d.A,{size:20}),"Upload"]}),(0,t.jsxs)(N,{href:"/decor",className:"mobile-menu-link",onClick:()=>A(!1),children:[(0,t.jsx)(h.A,{size:20}),"Items"]}),w&&C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(N,{href:"/user/".concat(C.id),className:"mobile-menu-link",onClick:()=>A(!1),children:[(0,t.jsx)(x,{size:20}),"My Profile"]}),(0,t.jsxs)(N,{href:"/settings",className:"mobile-menu-link",onClick:()=>A(!1),children:[(0,t.jsx)(j.A,{size:20}),"Settings"]}),"admin"===C.role&&(0,t.jsxs)(N,{href:"/admin",className:"mobile-menu-link mobile-menu-admin",onClick:()=>A(!1),children:[(0,t.jsx)(g.A,{size:20}),"Admin Panel"]}),(0,t.jsxs)("button",{className:"mobile-menu-link",onClick:()=>{_(),A(!1)},children:[(0,t.jsx)(k,{size:20}),"Logout"]})]}):(0,t.jsx)("div",{className:"mobile-menu-login",children:(0,t.jsx)(f.m,{size:"large"})})]})]})]})})}},6617:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},6651:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6924:(e,a,s)=>{"use strict";s.d(a,{A:()=>h,O:()=>d});var t=s(5155),r=s(2115),n=s(7481),l=s(8900);let i="2ae28e019b8f4fcc9e8b4df7ca2236ec",c=(0,r.createContext)(null),o="gearforge_session";function d(e){let{children:a}=e,[s,d]=(0,r.useState)(null),[h,u]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{p(!0);let e=localStorage.getItem(o);e&&d(e)},[]);let x=(0,n.IT)(l.FH.auth.getCurrentUser,s?{sessionToken:s}:"skip"),j=(0,n.n_)(l.FH.auth.loginWithBlizzard),g=(0,n.n_)(l.FH.auth.logout),k=!m||null!==s&&void 0===x;(0,r.useEffect)(()=>{m&&s&&null===x&&!k&&(localStorage.removeItem(o),d(null))},[m,s,x,k]);let b=async e=>{u(!0);try{let a=await fetch("/api/auth/callback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to authenticate")}let{battlenetId:s,battleTag:t}=await a.json(),r=await j({battlenetId:s,battleTag:t,avatarUrl:void 0});localStorage.setItem(o,r.token),d(r.token)}catch(e){throw console.error("OAuth error:",e),e}finally{u(!1)}},v=async()=>{s&&(await g({sessionToken:s}),localStorage.removeItem(o),d(null))};return(0,t.jsx)(c.Provider,{value:{user:x||null,sessionToken:s,isLoading:k||h,isAuthenticated:!!x,login:()=>{if(!i){console.error("NEXT_PUBLIC_BLIZZARD_CLIENT_ID not configured"),alert("Blizzard login is not configured. Please set up OAuth credentials.");return}let e=crypto.randomUUID();sessionStorage.setItem("oauth_state",e);let a=new URLSearchParams({client_id:i,redirect_uri:"http://localhost:3000/auth/callback",response_type:"code",scope:"openid",state:e});window.location.href="".concat("https://oauth.battle.net/authorize","?").concat(a)},logout:v,handleOAuthCallback:b},children:a})}function h(){let e=(0,r.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},7910:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},8839:(e,a,s)=>{"use strict";s.d(a,{ConvexClientProvider:()=>i});var t=s(5155),r=s(7481),n=s(6924),l=s(2115);function i(e){let{children:a}=e,[s]=(0,l.useState)(()=>new r.eH("https://perceptive-lemming-575.convex.cloud"));return(0,t.jsx)(r.hD,{client:s,children:(0,t.jsx)(n.O,{children:a})})}},8900:(e,a,s)=>{"use strict";s.d(a,{FH:()=>r});var t=s(5991);let r=t.dp;(0,t.Op)()}},e=>{e.O(0,[32,619,237,441,255,358],()=>e(e.s=5151)),_N_E=e.O()}]);