(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{508:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2529:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5870:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5880:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},6046:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},6132:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6611:(e,t,a)=>{Promise.resolve().then(a.bind(a,6612))},6612:(e,t,a)=>{"use strict";a.d(t,{SettingsPageClient:()=>v});var s=a(5155),r=a(2115),l=a(2619),i=a.n(l),n=a(7481),c=a(8900),o=a(6924),d=a(9708),h=a(5870),u=a(2529),p=a(6132),m=a(508),g=a(5880),y=a(6046);function v(){let{user:e,isLoading:t,sessionToken:a}=(0,o.A)(),[l,v]=(0,r.useState)(""),[x,f]=(0,r.useState)(""),[j,b]=(0,r.useState)(""),[k,w]=(0,r.useState)(!1),[A,N]=(0,r.useState)(null),[S,z]=(0,r.useState)(!1),B=(0,n.IT)(c.FH.users.getProfile,e?{id:e.id}:"skip"),_=(0,n.n_)(c.FH.users.updateProfile);if((0,r.useEffect)(()=>{B&&(v(B.bio||""),f(B.twitchUrl||""),b(B.youtubeUrl||""))},[B]),t)return(0,s.jsx)("div",{className:"container page-section",children:(0,s.jsx)("div",{style:{minHeight:"50vh"}})});if(!e)return(0,s.jsx)("div",{className:"container page-section",children:(0,s.jsxs)("div",{className:"placeholder-page",children:[(0,s.jsx)("div",{className:"empty-state-icon",children:(0,s.jsx)(d.A,{size:48})}),(0,s.jsx)("h2",{className:"font-display",style:{marginBottom:"var(--space-md)"},children:"Login Required"}),(0,s.jsx)("p",{className:"text-secondary",style:{marginBottom:"var(--space-xl)"},children:"Please log in to access your settings."}),(0,s.jsx)(i(),{href:"/",className:"btn btn-primary",children:"Return Home"})]})});let I=async e=>{if(e.preventDefault(),!a)return void N("Session expired. Please log in again.");w(!0),N(null),z(!1);try{await _({sessionToken:a,bio:l.trim()||void 0,twitchUrl:x.trim()||void 0,youtubeUrl:j.trim()||void 0}),z(!0),setTimeout(()=>z(!1),3e3)}catch(e){console.error("Failed to update profile:",e),N(e instanceof Error?e.message:"Failed to save changes")}finally{w(!1)}};return(0,s.jsxs)("div",{className:"container page-section",children:[(0,s.jsxs)("div",{style:{marginBottom:"var(--space-xl)"},children:[(0,s.jsxs)("h1",{className:"font-display",style:{fontSize:"2rem",marginBottom:"var(--space-sm)",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[(0,s.jsx)(h.A,{size:28}),"Settings"]}),(0,s.jsx)("p",{className:"text-secondary",children:"Manage your profile and preferences"})]}),S&&(0,s.jsxs)("div",{className:"card",style:{padding:"var(--space-md)",marginBottom:"var(--space-lg)",background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[(0,s.jsx)(u.A,{size:18,style:{color:"#22c55e"}}),(0,s.jsx)("span",{style:{color:"#22c55e"},children:"Profile updated successfully!"})]}),A&&(0,s.jsxs)("div",{className:"card",style:{padding:"var(--space-md)",marginBottom:"var(--space-lg)",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[(0,s.jsx)(p.A,{size:18,style:{color:"#ef4444"}}),(0,s.jsx)("span",{style:{color:"#ef4444"},children:A})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 300px",gap:"var(--space-xl)"},children:[(0,s.jsxs)("form",{onSubmit:I,children:[(0,s.jsxs)("div",{className:"card",style:{padding:"var(--space-lg)",marginBottom:"var(--space-lg)"},children:[(0,s.jsxs)("h2",{style:{marginBottom:"var(--space-lg)",display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[(0,s.jsx)(m.A,{size:20}),"Profile"]}),(0,s.jsxs)("div",{style:{marginBottom:"var(--space-lg)"},children:[(0,s.jsx)("label",{htmlFor:"bio",style:{display:"block",marginBottom:"var(--space-xs)",fontWeight:500},children:"Bio"}),(0,s.jsx)("textarea",{id:"bio",value:l,onChange:e=>v(e.target.value),placeholder:"Tell others about yourself and your housing designs...",className:"input",rows:4,maxLength:500,style:{width:"100%",resize:"vertical"}}),(0,s.jsxs)("div",{className:"text-muted",style:{fontSize:"0.875rem",marginTop:"var(--space-xs)"},children:[l.length,"/500 characters"]})]}),(0,s.jsxs)("div",{style:{marginBottom:"var(--space-md)"},children:[(0,s.jsx)("label",{htmlFor:"twitch",style:{display:"block",marginBottom:"var(--space-xs)",fontWeight:500},children:"Twitch"}),(0,s.jsxs)("div",{style:{position:"relative"},children:[(0,s.jsx)("input",{id:"twitch",type:"text",value:x,onChange:e=>f(e.target.value),placeholder:"twitch.tv/username or just username",className:"input",style:{width:"100%",paddingRight:"2.5rem"}}),x&&(0,s.jsx)("a",{href:x.includes("twitch.tv")?x:"https://twitch.tv/".concat(x),target:"_blank",rel:"noopener noreferrer",style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--accent)"},children:(0,s.jsx)(g.A,{size:16})})]})]}),(0,s.jsxs)("div",{style:{marginBottom:"var(--space-md)"},children:[(0,s.jsx)("label",{htmlFor:"youtube",style:{display:"block",marginBottom:"var(--space-xs)",fontWeight:500},children:"YouTube"}),(0,s.jsxs)("div",{style:{position:"relative"},children:[(0,s.jsx)("input",{id:"youtube",type:"text",value:j,onChange:e=>b(e.target.value),placeholder:"youtube.com/@channel or just @channel",className:"input",style:{width:"100%",paddingRight:"2.5rem"}}),j&&(0,s.jsx)("a",{href:j.includes("youtube.com")||j.includes("youtu.be")?j:"https://youtube.com/@".concat(j.replace("@","")),target:"_blank",rel:"noopener noreferrer",style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--accent)"},children:(0,s.jsx)(g.A,{size:16})})]})]})]}),(0,s.jsxs)("button",{type:"submit",className:"btn btn-primary",disabled:k,style:{display:"flex",alignItems:"center",gap:"var(--space-xs)"},children:[(0,s.jsx)(y.A,{size:18}),k?"Saving...":"Save Changes"]})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"card",style:{padding:"var(--space-lg)"},children:[(0,s.jsx)("h3",{style:{marginBottom:"var(--space-md)"},children:"Profile Preview"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-md)",marginBottom:"var(--space-md)"},children:[(0,s.jsx)("div",{style:{width:64,height:64,borderRadius:"50%",background:"var(--surface-elevated)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,s.jsx)(m.A,{size:28})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:600,fontSize:"1.125rem"},children:e.battleTag.split("#")[0]}),(0,s.jsxs)("div",{className:"text-muted",style:{fontSize:"0.875rem"},children:[(null==B?void 0:B.creationCount)||0," designs"]})]})]}),l&&(0,s.jsx)("p",{className:"text-secondary",style:{fontSize:"0.875rem",marginBottom:"var(--space-md)"},children:l}),(x||j)&&(0,s.jsxs)("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[x&&(0,s.jsx)("span",{className:"badge badge-outline",children:"Twitch"}),j&&(0,s.jsx)("span",{className:"badge badge-outline",children:"YouTube"})]}),(0,s.jsx)(i(),{href:"/user/".concat(e.id),className:"btn btn-secondary",style:{width:"100%",marginTop:"var(--space-lg)"},children:"View Public Profile"})]})})]})]})}},6924:(e,t,a)=>{"use strict";a.d(t,{A:()=>h,O:()=>d});var s=a(5155),r=a(2115),l=a(7481),i=a(8900);let n="2ae28e019b8f4fcc9e8b4df7ca2236ec",c=(0,r.createContext)(null),o="gearforge_session";function d(e){let{children:t}=e,[a,d]=(0,r.useState)(null),[h,u]=(0,r.useState)(!1),[p,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{m(!0);let e=localStorage.getItem(o);e&&d(e)},[]);let g=(0,l.IT)(i.FH.auth.getCurrentUser,a?{sessionToken:a}:"skip"),y=(0,l.n_)(i.FH.auth.loginWithBlizzard),v=(0,l.n_)(i.FH.auth.logout),x=!p||null!==a&&void 0===g;(0,r.useEffect)(()=>{p&&a&&null===g&&!x&&(localStorage.removeItem(o),d(null))},[p,a,g,x]);let f=async e=>{u(!0);try{let t=await fetch("/api/auth/callback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to authenticate")}let{battlenetId:a,battleTag:s}=await t.json(),r=await y({battlenetId:a,battleTag:s,avatarUrl:void 0});localStorage.setItem(o,r.token),d(r.token)}catch(e){throw console.error("OAuth error:",e),e}finally{u(!1)}},j=async()=>{a&&(await v({sessionToken:a}),localStorage.removeItem(o),d(null))};return(0,s.jsx)(c.Provider,{value:{user:g||null,sessionToken:a,isLoading:x||h,isAuthenticated:!!g,login:()=>{if(!n){console.error("NEXT_PUBLIC_BLIZZARD_CLIENT_ID not configured"),alert("Blizzard login is not configured. Please set up OAuth credentials.");return}let e=crypto.randomUUID();sessionStorage.setItem("oauth_state",e);let t=new URLSearchParams({client_id:n,redirect_uri:"http://localhost:3000/auth/callback",response_type:"code",scope:"openid",state:e});window.location.href="".concat("https://oauth.battle.net/authorize","?").concat(t)},logout:j,handleOAuthCallback:f},children:t})}function h(){let e=(0,r.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8900:(e,t,a)=>{"use strict";a.d(t,{FH:()=>r});var s=a(5991);let r=s.dp;(0,s.Op)()},9708:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{e.O(0,[619,237,441,255,358],()=>e(e.s=6611)),_N_E=e.O()}]);