(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[905],{690:(e,s,t)=>{"use strict";t.d(s,{DesignPageClient:()=>S});var a=t(5155),i=t(2115),r=t(2619),n=t.n(r),l=t(7481),o=t(8900),c=t(5626),d=t(368),g=t(7937),p=t(508),m=t(7828),h=t(3457),u=t(235),x=t(5917),v=t(5426),y=t(1010),b=t(1360),j=t(4589),f=t(5229),k=t(6132),N=t(63),C=t(6924),w=t(6147),I=t(8321);function S(e){let{id:s}=e,[t,r]=(0,i.useState)(!1),[S,_]=(0,i.useState)(0),[A,T]=(0,i.useState)(!1),[z,B]=(0,i.useState)(!1),[F,D]=(0,i.useState)(!1),[R,H]=(0,i.useState)("inappropriate"),[E,L]=(0,i.useState)(""),[P,O]=(0,i.useState)(!1),[W,U]=(0,i.useState)(null),[V,G]=(0,i.useState)(!1),[J,Z]=(0,i.useState)(!1),[K,M]=(0,i.useState)(!1),X=(0,N.useRouter)(),Y=(0,l.IT)(o.FH.creations.getById,{id:s}),q=(0,l.n_)(o.FH.creations.incrementViews),Q=(0,l.n_)(o.FH.likes.toggle),$=(0,l.n_)(o.FH.saves.toggle),ee=(0,l.n_)(o.FH.reports.submit),es=(0,l.n_)(o.FH.creations.remove),{user:et,isAuthenticated:ea,sessionToken:ei}=(0,C.A)(),er=(0,l.IT)(o.FH.likes.hasLiked,et?{userId:et.id,creationId:s}:"skip"),en=(0,l.IT)(o.FH.saves.hasSaved,et?{userId:et.id,creationId:s}:"skip"),el=(0,l.IT)(o.FH.reports.hasReported,et?{userId:et.id,creationId:s}:"skip");(0,i.useEffect)(()=>{Y&&s&&q({id:s})},[s]);let eo=async()=>{if(null==Y?void 0:Y.importString)try{await navigator.clipboard.writeText(Y.importString),r(!0),setTimeout(()=>r(!1),2e3)}catch(e){console.error("Failed to copy:",e)}},ec=async()=>{if(ei&&!A){T(!0);try{await Q({sessionToken:ei,creationId:s})}catch(e){console.error("Failed to toggle like:",e)}finally{T(!1)}}},ed=async()=>{if(ei&&!z){B(!0);try{await $({sessionToken:ei,creationId:s})}catch(e){console.error("Failed to toggle save:",e)}finally{B(!1)}}},eg=async()=>{if(ei&&!P){O(!0),U(null);try{await ee({sessionToken:ei,creationId:s,reason:R,details:E.trim()||void 0}),G(!0),setTimeout(()=>{D(!1),G(!1),H("inappropriate"),L("")},2e3)}catch(e){console.error("Failed to submit report:",e),U(e instanceof Error?e.message:"Failed to submit report")}finally{O(!1)}}},ep=async()=>{if(ei&&!K){M(!0);try{await es({id:s,sessionToken:ei}),X.push("/browse")}catch(e){console.error("Failed to delete design:",e),alert(e instanceof Error?e.message:"Failed to delete design")}finally{M(!1),Z(!1)}}},em=et&&(null==Y?void 0:Y.creatorId)===et.id;if(void 0===Y)return(0,a.jsx)("div",{className:"container page-section",children:(0,a.jsx)("div",{style:{minHeight:"50vh"}})});if(null===Y)return(0,a.jsx)("div",{className:"container page-section",children:(0,a.jsxs)("div",{className:"placeholder-page",children:[(0,a.jsx)("h2",{className:"font-display",style:{marginBottom:"var(--space-md)"},children:"Design Not Found"}),(0,a.jsx)("p",{className:"text-secondary",style:{marginBottom:"var(--space-xl)"},children:"This design may have been removed or doesn't exist."}),(0,a.jsx)(n(),{href:"/browse",className:"btn btn-primary",children:"Browse Designs"})]})});let eh=Y.imageUrls||[],eu=eh.length>1,ex={"@context":"https://schema.org","@type":"CreativeWork",name:Y.title,description:Y.description||"".concat(w.B[Y.category]," housing design for World of Warcraft"),url:"https://gearforge.io/design/".concat(s),image:eh[0]||void 0,author:{"@type":"Person",name:Y.creatorName,url:"https://gearforge.io/user/".concat(Y.creatorId)},datePublished:new Date(Y._creationTime).toISOString(),interactionStatistic:[{"@type":"InteractionCounter",interactionType:"https://schema.org/LikeAction",userInteractionCount:Y.likeCount},{"@type":"InteractionCounter",interactionType:"https://schema.org/ViewAction",userInteractionCount:Y.viewCount}],keywords:["WoW housing",w.B[Y.category],...Y.tags].join(", ")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.default,{id:"design-jsonld",type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(ex)}}),(0,a.jsxs)("div",{className:"container page-section",children:[(0,a.jsxs)(n(),{href:"/browse",className:"design-back-link",children:[(0,a.jsx)(c.A,{size:18}),"Back to Browse"]}),(0,a.jsxs)("div",{className:"design-layout",children:[(0,a.jsx)("div",{className:"design-images",children:eh.length>0?(0,a.jsxs)("div",{className:"design-image-gallery",children:[(0,a.jsxs)("div",{className:"design-main-image",children:[(0,a.jsx)("img",{src:eh[S],alt:Y.title}),eu&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"gallery-nav gallery-nav-prev",onClick:()=>_(e=>0===e?eh.length-1:e-1),children:(0,a.jsx)(d.A,{size:24})}),(0,a.jsx)("button",{className:"gallery-nav gallery-nav-next",onClick:()=>_(e=>e===eh.length-1?0:e+1),children:(0,a.jsx)(g.A,{size:24})})]})]}),eu&&(0,a.jsx)("div",{className:"design-thumbnails",children:eh.map((e,s)=>(0,a.jsx)("button",{className:"design-thumbnail ".concat(s===S?"active":""),onClick:()=>_(s),children:(0,a.jsx)("img",{src:e,alt:"View ".concat(s+1)})},s))})]}):(0,a.jsx)("div",{className:"design-image-placeholder",children:(0,a.jsx)("img",{src:"/gearforge_logo_new.png",alt:"",className:"placeholder-logo"})})}),(0,a.jsxs)("div",{className:"design-info",children:[(0,a.jsxs)("div",{className:"design-header",children:[(0,a.jsx)("span",{className:"badge",children:w.B[Y.category]}),(0,a.jsx)("h1",{className:"design-title font-display",children:Y.title})]}),(0,a.jsxs)(n(),{href:"/user/".concat(Y.creatorId),className:"design-creator",children:[(0,a.jsx)("div",{className:"design-creator-avatar",children:(0,a.jsx)(p.A,{size:20})}),(0,a.jsxs)("span",{children:["by ",Y.creatorName]})]}),(0,a.jsx)("div",{className:"design-stats",children:(0,a.jsxs)("span",{className:"design-stat",children:[(0,a.jsx)(m.A,{size:16}),Y.viewCount," views"]})}),(0,a.jsxs)("div",{className:"design-actions",style:{display:"flex",gap:"var(--space-sm)",marginTop:"var(--space-md)"},children:[(0,a.jsxs)("button",{className:"btn ".concat(er?"btn-primary":"btn-secondary"),onClick:ec,disabled:!ea||A,style:{flex:1},children:[(0,a.jsx)(h.A,{size:18,fill:er?"currentColor":"none"}),Y.likeCount," ",1===Y.likeCount?"Like":"Likes"]}),(0,a.jsxs)("button",{className:"btn ".concat(en?"btn-primary":"btn-secondary"),onClick:ed,disabled:!ea||z,style:{flex:1},children:[(0,a.jsx)(u.A,{size:18,fill:en?"currentColor":"none"}),en?"Saved":"Save"]})]}),!ea&&(0,a.jsx)("p",{className:"text-muted",style:{fontSize:"0.875rem",marginTop:"var(--space-xs)"},children:"Log in to like and save designs"}),Y.description&&(0,a.jsx)("div",{className:"design-description",children:(0,a.jsx)("p",{children:Y.description})}),Y.tags&&Y.tags.length>0&&(0,a.jsx)("div",{className:"design-tags",children:Y.tags.map(e=>(0,a.jsx)("span",{className:"badge badge-outline",children:e},e))}),Y.importString&&(0,a.jsxs)("div",{className:"design-import",children:[(0,a.jsx)("h3",{children:"Import String"}),(0,a.jsxs)("div",{className:"design-import-box",children:[(0,a.jsxs)("code",{className:"design-import-preview",children:[Y.importString.slice(0,100),"..."]}),(0,a.jsxs)("button",{className:"btn ".concat(t?"btn-primary":"btn-secondary"),onClick:eo,children:[t?(0,a.jsx)(x.A,{size:18}):(0,a.jsx)(v.A,{size:18}),t?"Copied!":"Copy String"]})]})]}),em&&(0,a.jsx)("div",{style:{marginTop:"var(--space-lg)",paddingTop:"var(--space-lg)",borderTop:"1px solid var(--border)"},children:(0,a.jsxs)("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[(0,a.jsxs)(n(),{href:"/design/".concat(s,"/edit"),className:"btn btn-secondary",style:{flex:1},children:[(0,a.jsx)(y.A,{size:16}),"Edit Design"]}),(0,a.jsxs)("button",{className:"btn btn-ghost",onClick:()=>Z(!0),style:{color:"#ef4444"},children:[(0,a.jsx)(b.A,{size:16}),"Delete"]})]})}),ea&&(null==et?void 0:et.id)!==Y.creatorId&&(0,a.jsx)("div",{style:{marginTop:"var(--space-lg)",paddingTop:"var(--space-lg)",borderTop:"1px solid var(--border)"},children:(0,a.jsxs)("button",{className:"btn btn-ghost",onClick:()=>D(!0),disabled:!0===el,style:{color:el?"var(--text-muted)":"var(--text-secondary)",fontSize:"0.875rem"},children:[(0,a.jsx)(j.A,{size:16}),el?"Reported":"Report Design"]})})]})]}),F&&(0,a.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"var(--space-lg)"},onClick:()=>!P&&D(!1),children:(0,a.jsx)("div",{className:"card",style:{maxWidth:480,width:"100%",padding:"var(--space-xl)"},onClick:e=>e.stopPropagation(),children:V?(0,a.jsxs)("div",{style:{textAlign:"center",padding:"var(--space-lg)"},children:[(0,a.jsx)(x.A,{size:48,style:{color:"#22c55e",marginBottom:"var(--space-md)"}}),(0,a.jsx)("h3",{style:{marginBottom:"var(--space-sm)"},children:"Report Submitted"}),(0,a.jsx)("p",{className:"text-secondary",children:"Thank you for helping keep GearForge safe."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-lg)"},children:[(0,a.jsxs)("h2",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)"},children:[(0,a.jsx)(j.A,{size:20}),"Report Design"]}),(0,a.jsx)("button",{className:"btn btn-ghost",onClick:()=>D(!1),disabled:P,style:{padding:"var(--space-xs)"},children:(0,a.jsx)(f.A,{size:20})})]}),W&&(0,a.jsxs)("div",{style:{padding:"var(--space-sm)",marginBottom:"var(--space-md)",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",gap:"var(--space-xs)",color:"#ef4444",fontSize:"0.875rem"},children:[(0,a.jsx)(k.A,{size:16}),W]}),(0,a.jsxs)("div",{style:{marginBottom:"var(--space-lg)"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"var(--space-sm)",fontWeight:500},children:"Reason for report"}),(0,a.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-xs)"},children:[{value:"inappropriate",label:"Inappropriate content"},{value:"spam",label:"Spam or misleading"},{value:"stolen",label:"Stolen design"},{value:"broken",label:"Broken / doesn't work"},{value:"other",label:"Other"}].map(e=>(0,a.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"var(--space-sm)",padding:"var(--space-sm)",background:R===e.value?"var(--surface-elevated)":"transparent",borderRadius:"var(--radius)",cursor:"pointer"},children:[(0,a.jsx)("input",{type:"radio",name:"reportReason",value:e.value,checked:R===e.value,onChange:e=>H(e.target.value)}),e.label]},e.value))})]}),(0,a.jsxs)("div",{style:{marginBottom:"var(--space-lg)"},children:[(0,a.jsx)("label",{htmlFor:"reportDetails",style:{display:"block",marginBottom:"var(--space-xs)",fontWeight:500},children:"Additional details (optional)"}),(0,a.jsx)("textarea",{id:"reportDetails",value:E,onChange:e=>L(e.target.value),placeholder:"Provide any additional context...",className:"input",rows:3,maxLength:500,style:{width:"100%",resize:"vertical"}})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"var(--space-sm)",justifyContent:"flex-end"},children:[(0,a.jsx)("button",{className:"btn btn-secondary",onClick:()=>D(!1),disabled:P,children:"Cancel"}),(0,a.jsx)("button",{className:"btn btn-primary",onClick:eg,disabled:P,children:P?"Submitting...":"Submit Report"})]})]})})}),J&&(0,a.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"var(--space-lg)"},onClick:()=>!K&&Z(!1),children:(0,a.jsx)("div",{className:"card",style:{maxWidth:400,width:"100%",padding:"var(--space-xl)"},onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)(b.A,{size:48,style:{color:"#ef4444",marginBottom:"var(--space-md)"}}),(0,a.jsx)("h2",{style:{marginBottom:"var(--space-sm)"},children:"Delete Design?"}),(0,a.jsx)("p",{className:"text-secondary",style:{marginBottom:"var(--space-lg)"},children:"This action cannot be undone. Your design will be permanently removed."}),(0,a.jsxs)("div",{style:{display:"flex",gap:"var(--space-sm)",justifyContent:"center"},children:[(0,a.jsx)("button",{className:"btn btn-secondary",onClick:()=>Z(!1),disabled:K,children:"Cancel"}),(0,a.jsx)("button",{className:"btn",onClick:ep,disabled:K,style:{background:"#ef4444",color:"white"},children:K?"Deleting...":"Delete Design"})]})]})})})]})]})}},3730:(e,s,t)=>{Promise.resolve().then(t.bind(t,690))},6147:(e,s,t)=>{"use strict";t.d(s,{B:()=>a,R:()=>i});let a={bedroom:"Bedroom",living_room:"Living Room",kitchen:"Kitchen",garden:"Garden",tavern:"Tavern",throne_room:"Throne Room",workshop:"Workshop",library:"Library",exterior:"Exterior",other:"Other"},i=["bedroom","living_room","kitchen","garden","tavern","throne_room","workshop","library","exterior","other"]},6924:(e,s,t)=>{"use strict";t.d(s,{A:()=>g,O:()=>d});var a=t(5155),i=t(2115),r=t(7481),n=t(8900);let l="2ae28e019b8f4fcc9e8b4df7ca2236ec",o=(0,i.createContext)(null),c="gearforge_session";function d(e){let{children:s}=e,[t,d]=(0,i.useState)(null),[g,p]=(0,i.useState)(!1),[m,h]=(0,i.useState)(!1);(0,i.useEffect)(()=>{h(!0);let e=localStorage.getItem(c);e&&d(e)},[]);let u=(0,r.IT)(n.FH.auth.getCurrentUser,t?{sessionToken:t}:"skip"),x=(0,r.n_)(n.FH.auth.loginWithBlizzard),v=(0,r.n_)(n.FH.auth.logout),y=!m||null!==t&&void 0===u;(0,i.useEffect)(()=>{m&&t&&null===u&&!y&&(localStorage.removeItem(c),d(null))},[m,t,u,y]);let b=async e=>{p(!0);try{let s=await fetch("/api/auth/callback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to authenticate")}let{battlenetId:t,battleTag:a}=await s.json(),i=await x({battlenetId:t,battleTag:a,avatarUrl:void 0});localStorage.setItem(c,i.token),d(i.token)}catch(e){throw console.error("OAuth error:",e),e}finally{p(!1)}},j=async()=>{t&&(await v({sessionToken:t}),localStorage.removeItem(c),d(null))};return(0,a.jsx)(o.Provider,{value:{user:u||null,sessionToken:t,isLoading:y||g,isAuthenticated:!!u,login:()=>{if(!l){console.error("NEXT_PUBLIC_BLIZZARD_CLIENT_ID not configured"),alert("Blizzard login is not configured. Please set up OAuth credentials.");return}let e=crypto.randomUUID();sessionStorage.setItem("oauth_state",e);let s=new URLSearchParams({client_id:l,redirect_uri:"http://localhost:3000/auth/callback",response_type:"code",scope:"openid",state:e});window.location.href="".concat("https://oauth.battle.net/authorize","?").concat(s)},logout:j,handleOAuthCallback:b},children:s})}function g(){let e=(0,i.useContext)(o);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8900:(e,s,t)=>{"use strict";t.d(s,{FH:()=>i});var a=t(5991);let i=a.dp;(0,a.Op)()}},e=>{e.O(0,[619,237,624,441,255,358],()=>e(e.s=3730)),_N_E=e.O()}]);