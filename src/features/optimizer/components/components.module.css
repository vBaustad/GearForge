/* Optimizer components styling (matches Rewards/Guides black-glass look) */

/* ─────────────────────────────────────────
   Generic card surface
────────────────────────────────────────── */
.cardPanel{
  /* Align with updated feature card surface */
  background: linear-gradient(180deg, #181a20, #121318);
  border: 1px solid #1f2024;
  border-radius: 10px;
  padding: 12px;
  color: var(--ink);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.02);
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
}
.cardPanel:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(0,0,0,.25);
  border-color: rgba(255,179,0,.18);
}

/* =====================
   Paperdoll layout + slot cards
===================== */

.paperdoll{
  display:grid;
  grid-template-columns: minmax(220px,1fr) minmax(220px,1fr);
  gap:10px;
  margin-top:12px;
  /* Ensure two true columns regardless of DOM order */
  grid-auto-flow: column;
  align-items:start;
  align-content:start;
}
.paperdoll > * { min-width:0; }
.colLeft{ grid-column:1; }
.colRight{ grid-column:2; }

.weaponsRow{
  grid-column:1 / 3; /* span both columns; sits after slot cards */
  display:flex;
  gap:10px;
  justify-content:center;
  margin-top:4px;
}
.weaponSlot{ flex:0 0 500px; }

/* Base rarity variable — set on both slot cards and narrative rows */
.slotCard, .recRow, .row { --rarity-color: var(--ink); }

/* Rarity → color variable + (for Paperdoll) border tint */
.slotCard[data-rarity="poor"],     .recRow[data-rarity="poor"],     .row[data-rarity="poor"]      { --rarity-color:#9ca3af; }
.slotCard[data-rarity="common"],   .recRow[data-rarity="common"],   .row[data-rarity="common"]    { --rarity-color:#d1d5db; }
.slotCard[data-rarity="uncommon"], .recRow[data-rarity="uncommon"], .row[data-rarity="uncommon"]  { --rarity-color:#1eff00; }
.slotCard[data-rarity="rare"],     .recRow[data-rarity="rare"],     .row[data-rarity="rare"]      { --rarity-color:#0070dd; }
.slotCard[data-rarity="epic"],     .recRow[data-rarity="epic"],     .row[data-rarity="epic"]      { --rarity-color:#a335ee; }
.slotCard[data-rarity="legendary"],.recRow[data-rarity="legendary"],.row[data-rarity="legendary"] { --rarity-color:#ff8000; }
.slotCard[data-rarity="artifact"], .recRow[data-rarity="artifact"], .row[data-rarity="artifact"]  { --rarity-color:#e6cc80; }
.slotCard[data-rarity="artifact"], .recRow[data-rarity="artifact"], .row[data-rarity="artifact"]  { --rarity-color:#e6cc80; }

.slotCard{
  background: linear-gradient(180deg, #181a20, #121318);
  border:1px solid #1f2024;
  border-radius:10px;
  padding:10px 56px 10px 10px; /* reserve space for top-right ilvl pill */
  color:var(--ink);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.02);
  position:relative; /* anchor for top-right pill */
}

/* Subtle border tint by rarity (Paperdoll) */
.slotCard[data-rarity="poor"]{       border-color:#404247; }
.slotCard[data-rarity="common"]{     border-color:#2a2c31; }
.slotCard[data-rarity="uncommon"]{   border-color:rgba(30, 255, 0, 1); }
.slotCard[data-rarity="rare"]{       border-color:rgba(0, 112, 221, 1); }
.slotCard[data-rarity="epic"]{       border-color:rgba(163, 53, 238, 1); }
.slotCard[data-rarity="legendary"]{  border-color:rgba(255, 128, 0, 1); }
.slotCard[data-rarity="artifact"]  { border-color: rgba(230, 204, 128, 1); }
.slotCard[data-rarity="heirloom"]  { border-color: rgba(0, 204, 255, 1); }

/* Item name coloring (Paperdoll + Narrative) */
/* .slotCard[data-rarity="artifact"] .itemName,
.recRow[data-rarity="artifact"] .itemName,
.recRow[data-rarity="artifact"] .itemTitle { color: #e6cc80; }

.slotCard[data-rarity="heirloom"] .itemName,
.recRow[data-rarity="heirloom"] .itemName,
.recRow[data-rarity="heirloom"] .itemTitle { color: #00ccff; } */

/* Upgrade state accent */
.slotCard[data-has-upgrade]{
  box-shadow: 0 0 0 1px rgba(255,179,0,.18) inset, inset 0 1px 0 rgba(255,255,255,.02);
}

.slotLabel{
  font-size:11px;
  color:var(--ink-dim);
  margin: -2px 0 6px;
}

/* The whole row can be a link — make it inherit color so rarity wins */
.slotItem { color: inherit; text-decoration: none; }
.slotItem:link,
.slotItem:visited,
.slotItem:hover,
.slotItem:active { color: inherit; }

.slotItem{
  display:grid;
  grid-template-columns: 52px 1fr; /* icon | text */
  align-items:stretch; /* make icon match text column height */
  gap:10px;
}
.slotIcon{
  width:52px; height:100%; min-height:52px;
  display:flex; align-items:center; justify-content:center;
}
/* Ensure the inner <img> scales to the slot box */
.slotIcon img{ width:100%; height:100%; object-fit:cover; }

/* Right text column: name on top, pills below */
.textCol{ display:flex; flex-direction:column; gap:6px; min-height:52px; }
.textCol.isSolo{ justify-content:center; }
.pillsRow{ display:flex; align-items:center; gap:6px; flex-wrap:wrap; }

/* Weapon cards keep same internals; only width is constrained via flex above */

.nameRow{
  display:flex; align-items:center; gap:8px;
}
.nameRow.isSolo{ margin-bottom:2px; }

/* Name picks up rarity color via variable */
.itemName{ font-weight:700; line-height:1.2; color: var(--rarity-color); }

.subRow{ margin-top:6px; display:flex; align-items:center; gap:6px; }

.upgradePill,
.ilvlPill{
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 8px; border-radius:999px; font-size:12px;
  border:1px solid #2a2c31; background:#1f2126; color:var(--ink);
}
.upgradePill{ border-color: rgba(255,179,0,.35); background:rgba(255,179,0,.08); color:var(--ink); }
.upgradeDelta{ font-variant-numeric: tabular-nums; font-weight:800; }

/* Always place ilvl/upgrade pill in card corner */
.pillTopRight{ position:absolute; top:8px; right:8px; }

.upgradePillSecondary{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:2px 8px;
  border-radius:999px;
  font-size:11px;
  line-height:1;
  border:1px solid rgba(255,179,0,.28);
  background:rgba(255,179,0,.08);
  color:var(--ink-dim);
  white-space:nowrap;
}
.craftedPill{
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 8px; border-radius:999px; font-size:11px;
  border:1px solid #2a2c31; color:var(--ink-dim); background:#1b1d22;
}

.slotEmpty{
  height:52px; display:flex; align-items:center; justify-content:center;
  color:var(--ink-dim);
}

/* =====================
   Narrative plan (upgrade list — legacy "recRow" pieces kept)
===================== */
.card{
  background: linear-gradient(180deg, #181a20, #121318);
  border:1px solid #1f2024;
  border-radius:10px;
  margin-top: 12px;
  padding:12px;
  color:var(--ink);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.02);
}
.cardTitle{ margin:0 0 6px; font-weight:800; letter-spacing:.2px; }
.helperText{ margin:6px 0 0; color:var(--ink-dim); }

.recList{ list-style:none; margin:10px 0 0; padding:0; display:grid; gap:8px; }
.recRow{
  display:grid;
  grid-template-columns: 260px 1fr auto auto; /* icon+name | text | delta | pills */
  align-items:center;
  gap:10px;
  padding:8px 10px;
  border:1px solid #2a2c31;
  border-radius:8px;
  background:#15171b;
  transition: border-color .12s ease, transform .12s ease, box-shadow .12s ease;
}
.recRow:hover{
  border-color: rgba(255,179,0,.28);
  box-shadow: 0 6px 16px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.02);
  transform: translateY(-1px);
}

/* ========== Narrative left column (icon + name + slot) ========== */
.itemCell{ display:flex; align-items:center; gap:10px; }
.itemIcon{
  width:40px; height:40px; border-radius:8px; object-fit:cover;
  box-shadow: inset 0 0 0 1px #2a2c31; flex:0 0 40px;
}
.itemText{ display:flex; flex-direction:column; min-width:0; }
/* Title consumes the same rarity variable */
.itemTitle{ font-weight:800; line-height:1.1; color: var(--rarity-color); }
.itemSub{ margin-top:2px; font-size:12px; color:var(--ink-dim); }

/* Keep the upgrade line + reason line visually grouped */
.mainCol{ display:flex; flex-direction:column; gap:4px; }
.upgradeHeadline{ line-height:1.25; }
.metaRow{
  color:var(--ink-dim); font-size:12px;
  display:flex; flex-wrap:wrap; align-items:center; gap:8px;
}

/* Slot cell supports icon + label (legacy helper) */
.slot{
  display:flex; align-items:center; gap:8px;
  font-weight:700; color:var(--ink); letter-spacing:.1px;
}
.slotIconSmall{
  width:22px; height:22px; border-radius:4px; object-fit:cover;
  border:1px solid #2a2c31; box-shadow: 0 1px 0 rgba(255,255,255,.04) inset;
}

/* Generic text bits */
.meta{
  color:var(--ink-dim);
  font-size:12px;
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  gap:8px;
}
.badge{
  display:inline-block;
  padding:2px 6px;
  border:1px solid #2a2c31;
  border-radius:999px;
  font-size:11px;
  line-height:1.1;
}

/* Tabs: lean underline style (legacy) */
[role="tablist"]{ margin-bottom:8px; display:flex; gap:14px; border-bottom:1px solid #23242a; }
[role="tab"]{
  appearance:none; background:none; border:none; padding:8px 2px; margin:0;
  color:var(--ink-dim); font-weight:700; cursor:pointer; position:relative;
}
[role="tab"]:hover{ color:var(--ink); }
[role="tab"][aria-selected="true"]{ color:var(--ink); }
[role="tab"][aria-selected="true"]::after{
  content:""; position:absolute; left:0; right:0; bottom:-1px; height:2px;
  background: linear-gradient(90deg, rgba(255,179,0,0), rgba(255,179,0,.9), rgba(255,179,0,0));
  border-radius:2px;
}

/* Crest totals */
.crestBar{
  display:flex;
  flex-wrap:wrap;             /* allow wrap on small widths */
  align-items:center;
  gap:8px;
  padding:6px 8px;
  border:1px solid #2a2c31;
  border-radius:8px;
  background:#15171b;
}
.crestTotalPill{
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 8px; border-radius:999px;
  border:1px solid rgba(255,179,0,.25);
}
.crestTotalLabel{ font-size:12px; color:var(--ink-dim); }
.crestTotalValue{ font-weight:800; }
.crestTotalsRow{ display:flex; flex-wrap:wrap; gap:6px; }
.crestPill{
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 6px; border:1px solid #2a2c31; border-radius:999px; font-size:11px;
}
.crestPillTier{ opacity:.85; }
.crestPillValue{ font-weight:800; font-variant-numeric: tabular-nums; }

/* ─────────────────────────────────────────
   NarrativePlan v2 (tabs + sequence rows)
────────────────────────────────────────── */
.wrap { margin-top: 12px; }

.tabs{
  display:flex;
  align-items:center;
  gap:14px;
  border-bottom:1px solid #23242a;
  padding-bottom:6px;
}

.tabBtn{
  appearance:none; background:none; border:none; margin:0;
  padding:8px 2px; cursor:pointer;
  color:var(--ink-dim); font-weight:700; position:relative;
}
.tabBtn:hover{ color:var(--ink); }
.tabActive{ color:var(--ink); }
.tabActive::after{
  content:""; position:absolute; left:0; right:0; bottom:-1px; height:2px;
  background:linear-gradient(90deg, rgba(255,179,0,0), rgba(255,179,0,.9), rgba(255,179,0,0));
  border-radius:2px;
}

.rightPills{
  margin-left:auto;
  display:flex; align-items:center; gap:8px; flex-wrap:wrap;
}

/* Empty state for NarrativePlan */
.empty{
  border:1px solid #2a2c31; border-radius:8px; background:#15171b;
  padding:16px; text-align:center;
}
.emptyText{ margin-top:8px; color:var(--ink-dim); }

/* Sequence list */
.list{ list-style:none; margin:10px 0 0; padding:0; display:grid; gap:8px; }

.row{
  display:grid;
  grid-template-columns: 1fr auto; /* main | right pill */
  align-items:center;
  gap:10px;
  padding:8px 10px;
  border:1px solid #2a2c31;
  border-radius:8px;
  background:#15171b;
  transition: border-color .12s ease, transform .12s ease, box-shadow .12s ease;
}
.row:hover{
  border-color: rgba(255,179,0,.28);
  box-shadow: 0 6px 16px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.02);
  transform: translateY(-1px);
}

.main{ display:flex; align-items:flex-start; gap:10px; }
.iconWrap{
  width:40px; height:40px; flex:0 0 40px;
  border-radius:8px; overflow:hidden;
  border:1px solid #2a2c31; background:#1b1d22;
}
.icon{ width:100%; height:100%; object-fit:cover; display:block; }
.body{ display:flex; flex-direction:column; gap:6px; min-width:0; }

.titleRow{
  display:flex; align-items:center; gap:10px;
  justify-content:space-between;
}
.slotName{
  min-width:0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
  font-weight:700; color:var(--ink);
}
.row[data-rarity] .slotName strong{ color:var(--rarity-color); }
.stepIndex{ color:var(--ink-dim); margin-right:2px; }
.itemLabel{ color:var(--ink-dim); }

.crestPill{
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 6px; border:1px solid #2a2c31; border-radius:999px; font-size:11px;
  color:var(--ink-dim); white-space:nowrap;
}

.deltaRow{
  display:flex; align-items:center; gap:8px; flex-wrap:wrap;
  font-variant-numeric: tabular-nums;
}
.deltaKind{ color:var(--ink-dim); font-size:12px; }
.deltaNum{ font-weight:800; }
.deltaArrow{ vertical-align:-2px; opacity:.9; }
.rankChip{
  margin-left:4px;
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 8px; border-radius:999px; font-size:11px;
  border:1px solid #2a2c31; color:var(--ink-dim); background:#1b1d22;
}

.disclosure{
  appearance:none; background:none; border:none; padding:0;
  display:inline-flex; align-items:center; gap:6px;
  color:var(--ink-dim); cursor:pointer;
}
.disclosure:hover{ color:var(--ink); }

.steps{
  margin:4px 0 0 0; padding:0; list-style:none;
  display:grid; gap:4px;
}
.stepLine{ display:flex; align-items:flex-start; gap:8px; }
.stepBullet{ color:var(--ink-dim); width:18px; text-align:right; }
.stepText{ color:var(--ink-dim); }

.right{ display:flex; align-items:center; gap:8px; }

/* ─────────────────────────────────────────
   Flat table view (NarrativePlan: "All upgrades" tab)
────────────────────────────────────────── */
.table{
  margin-top:10px;
  display:grid;
  gap:8px;
}
.trHead{
  display:grid;
  grid-template-columns: 160px 1fr 110px 110px 1fr;
  gap:10px;
  padding:6px 10px 8px;
  color:var(--ink-dim);
  border-bottom:1px solid #23242a;
  font-weight:800;
  letter-spacing:.2px;
}
.thGrow{ min-width:0; }

.tr{
  display:grid;
  grid-template-columns: 160px 1fr 110px 110px 1fr;
  align-items:center;
  gap:10px;
  padding:8px 10px;
  border:1px solid #2a2c31;
  border-radius:8px;
  background:#15171b;
  transition: border-color .12s ease, transform .12s ease, box-shadow .12s ease;
}
.tr:hover{
  border-color: rgba(255,179,0,.28);
  box-shadow: 0 6px 16px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.02);
  transform: translateY(-1px);
}

.tdSlot{
  display:flex; align-items:center; gap:8px;
  min-width:0;
}
.iconMini{
  width:28px; height:28px; border-radius:6px; object-fit:cover;
  border:1px solid #2a2c31; box-shadow: 0 1px 0 rgba(255,255,255,.04) inset;
  flex:0 0 28px;
}
.tdGrow{ min-width:0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.inlineArrow{ vertical-align:-2px; opacity:.9; }
.tdWrap{ min-width:0; }

/* Responsive: collapse delta + pills under the text on narrow screens */
@media (max-width: 820px) {
  .recRow{
    grid-template-columns: 100px 1fr;
    align-items:start;
  }
  .recRow > :nth-child(3),
  .recRow > :nth-child(4){
    grid-column: 2;           /* move delta & pills under the text column */
    justify-self: start;
    margin-top: 6px;
  }
  .slot{ font-size:12px; }
  .itemName{ font-size:14px; }

  /* NarrativePlan v2 row tweaks */
  .row{ grid-template-columns: 1fr; align-items:start; }
  .right{ justify-self:start; margin-top:6px; }

  /* table tweaks */
  .trHead{
    grid-template-columns: 120px 1fr 90px 90px 1fr;
    font-size:12px;
  }
  .tr{
    grid-template-columns: 120px 1fr 90px 90px 1fr;
  }
}
@media (max-width: 560px) {
  .recRow{
    grid-template-columns: 88px 1fr;
    gap:8px;
  }
  .crestBar{ gap:6px; }

  /* table tweaks */
  .trHead{
    display:none; /* hide header on very small screens */
  }
  .tr{
    grid-template-columns: 1fr;   /* stack */
    gap:6px;
  }
  .tdSlot{ order:1; }
  .tdGrow{ order:2; }
  .tr > :nth-child(3){ order:3; } /* ilvl */
  .tr > :nth-child(4){ order:4; } /* rank */
  .tdWrap{ order:5; }             /* crests */
}
